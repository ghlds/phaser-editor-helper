# phaser-editor-helper

[中文文档](./README.zh-cn.md) | [English Documentation](./README.md)

Phaser Editor Integration Helper

## Introduction

`phaser-editor-helper` is a `webpack` plugin designed to non-intrusively integrate `Phaser Editor` into projects using `webpack` for game development, and to process the output of `Phaser Editor`.

1. Filter the output, exclude non-code related files, and completely copy the code into the project.
2. Optimize the code in function mode, converting it to compositional code.
3. Provide friendly `Typescript` type hints, uniformly declare and export types for elements set as `public` in the editor。

By using `phaser-editor-helper`, developers can more easily manage and use the code generated by `Phaser Editor`, avoiding the confusion caused by `Phaser Editor`'s output in project management.

## Installation

```bash
npm install phaser-editor-helper --save-dev
```

## Features

### 1. Code Conversion

The plugin will convert the code in function mode to compositional code and add type declarations for the scene.

### 2. File Watching

In development mode, the plugin will watch the editor's working directory, automatically convert the code and copy it to the project.

### 3. Clean Non-JSON Files

In production mode, the plugin will clean non-JSON files in the working directory. Production mode does not require the editor's working files, such as `.scene`, etc., and the files in the `publicroot` directory will not be included in the package.

## Integrate into Webpack Project

### Preparations Before Integration

1. Choose a static resource directory set by webpack, such as: `/public`
2. Create a [`publicroot`](https://help-v3.phasereditor2d.com/asset-pack-editor/public-root.html) file specified by Phaser Editor
3. Create a working directory for Phaser Editor containing scenes, node scripts, etc., such as: `/editor`

## Configuration Options

- `watchDir`: The directory to watch.
- `outputDir`: The output directory.
- `excludePatterns`: The file patterns to exclude, default is an empty array.
- `conversionDir`: The directory to process.

## Example

Assume the project structure is as follows:

```
project
|—— public
|   └──assets
|   └──editor
|       └── scenes
|           └── Level
|               └── Scene.ts
|               └── Scene.scene
|       └── script-nodes
|   └──publicroot
├── src
|   └──editor
|       └── scenes
|       └── script-nodes
│   └── scenes
│       └── MyScene.ts
```

Add the `phaser-editor-helper` plugin in the webpack configuration:

```javascript
const PhaserEditorHelper = require("phaser-editor-helper");

module.exports = {
  // ...existing code...
  plugins: [
    new PhaserEditorHelper({
      watchDir: path.resolve(__dirname, 'public/editor'), // The directory to watch
      outputDir: path.resolve(__dirname, 'src/editor'), // The output directory
      excludePatterns: ['.scene', '.json', '.components', 'node_modules'], // Files to exclude
      conversionDir: "public/editor/scenes", // The directory to convert
    }),
  ],
};
```

Define the scene in the `src/scenes/MyScene.ts` file:

```typescript
import {
    preload,
    editorCreate,
    type SceneExtensions
} from "@/editor/scenes/Level/Scene";

export default class MyScene extends Phaser.Scene implements SceneExtensions {
    constructor() {
        super("MyScene");
    }
    image_1!: Phaser.GameObjects.Image; // From type hints
    preload() {
        preload(this);
    }
    create() {
        editorCreate(this);
        this.image_1.x = 0 // ...existing code...
    }
}
```